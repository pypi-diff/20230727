# Comparing `tmp/karton_yaramatcher-1.2.0-py3-none-any.whl.zip` & `tmp/karton_yaramatcher-1.3.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,14 +1,14 @@
-Zip file size: 6922 bytes, number of entries: 12
--rw-r--r--  2.0 unx      539 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0-nspkg.pth
--rw-r--r--  2.0 unx       79 b- defN 22-Jul-27 14:17 karton/yaramatcher/__init__.py
--rw-r--r--  2.0 unx       57 b- defN 22-Jul-27 14:17 karton/yaramatcher/__main__.py
--rw-r--r--  2.0 unx       22 b- defN 22-Jul-27 14:17 karton/yaramatcher/__version__.py
--rw-r--r--  2.0 unx     7836 b- defN 22-Jul-27 14:17 karton/yaramatcher/yaramatcher.py
--rw-r--r--  2.0 unx     1519 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     1542 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       76 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        7 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0.dist-info/namespace_packages.txt
--rw-r--r--  2.0 unx        7 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1095 b- defN 22-Jul-27 14:17 karton_yaramatcher-1.2.0.dist-info/RECORD
-12 files, 12871 bytes uncompressed, 5024 bytes compressed:  61.0%
+Zip file size: 6937 bytes, number of entries: 12
+-rw-r--r--  2.0 unx      539 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0-nspkg.pth
+-rw-r--r--  2.0 unx       79 b- defN 23-Jul-27 14:44 karton/yaramatcher/__init__.py
+-rw-r--r--  2.0 unx       57 b- defN 23-Jul-27 14:44 karton/yaramatcher/__main__.py
+-rw-r--r--  2.0 unx       22 b- defN 23-Jul-27 14:44 karton/yaramatcher/__version__.py
+-rw-r--r--  2.0 unx     7799 b- defN 23-Jul-27 14:44 karton/yaramatcher/yaramatcher.py
+-rw-r--r--  2.0 unx     1519 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1559 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       76 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        7 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0.dist-info/namespace_packages.txt
+-rw-r--r--  2.0 unx        7 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1095 b- defN 23-Jul-27 14:44 karton_yaramatcher-1.3.0.dist-info/RECORD
+12 files, 12851 bytes uncompressed, 5039 bytes compressed:  60.8%
```

## zipnote {}

```diff
@@ -1,37 +1,37 @@
-Filename: karton_yaramatcher-1.2.0-nspkg.pth
+Filename: karton_yaramatcher-1.3.0-nspkg.pth
 Comment: 
 
 Filename: karton/yaramatcher/__init__.py
 Comment: 
 
 Filename: karton/yaramatcher/__main__.py
 Comment: 
 
 Filename: karton/yaramatcher/__version__.py
 Comment: 
 
 Filename: karton/yaramatcher/yaramatcher.py
 Comment: 
 
-Filename: karton_yaramatcher-1.2.0.dist-info/LICENSE
+Filename: karton_yaramatcher-1.3.0.dist-info/LICENSE
 Comment: 
 
-Filename: karton_yaramatcher-1.2.0.dist-info/METADATA
+Filename: karton_yaramatcher-1.3.0.dist-info/METADATA
 Comment: 
 
-Filename: karton_yaramatcher-1.2.0.dist-info/WHEEL
+Filename: karton_yaramatcher-1.3.0.dist-info/WHEEL
 Comment: 
 
-Filename: karton_yaramatcher-1.2.0.dist-info/entry_points.txt
+Filename: karton_yaramatcher-1.3.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: karton_yaramatcher-1.2.0.dist-info/namespace_packages.txt
+Filename: karton_yaramatcher-1.3.0.dist-info/namespace_packages.txt
 Comment: 
 
-Filename: karton_yaramatcher-1.2.0.dist-info/top_level.txt
+Filename: karton_yaramatcher-1.3.0.dist-info/top_level.txt
 Comment: 
 
-Filename: karton_yaramatcher-1.2.0.dist-info/RECORD
+Filename: karton_yaramatcher-1.3.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## karton/yaramatcher/__version__.py

```diff
@@ -1 +1 @@
-__version__ = "1.2.0"
+__version__ = "1.3.0"
```

## karton/yaramatcher/yaramatcher.py

```diff
@@ -1,16 +1,17 @@
+import argparse
 import logging
 import os
 import re
 import tempfile
 import zipfile
 from typing import List, Optional
 
 import yara  # type: ignore
-from karton.core import Config, Karton, Task  # type: ignore
+from karton.core import Config, Karton, Task
 
 from .__version__ import __version__
 
 log = logging.getLogger(__name__)
 
 
 def normalize_rule_name(match: str) -> str:
@@ -27,15 +28,14 @@
 
 class YaraHandler:
     """Used to load and compile Yara rules from a folder and match them
     against a sample.
     """
 
     def __init__(self, path: Optional[str] = None) -> None:
-        super().__init__()
         # load and compile all Yara rules from a folder
         yara_path = path or "rules"
         rule_paths = []
 
         # if it's a directory, then walk recursively
         if os.path.isdir(yara_path):
             for root, _, f_names in os.walk(yara_path):
@@ -93,25 +93,23 @@
     @classmethod
     def args_parser(cls):
         parser = super().args_parser()
         parser.add_argument("--rules", help="Yara rules directory", default="rules")
         return parser
 
     @classmethod
-    def main(cls):
-        parser = cls.args_parser()
-        args = parser.parse_args()
-
-        config = Config(args.config_file)
-        service = YaraMatcher(config=config, yara_rule_dir=args.rules)
-        service.loop()
+    def config_from_args(cls, config: Config, args: argparse.Namespace) -> None:
+        super().config_from_args(config, args)
+        config.load_from_dict({"yaramatcher": {"rules": args.rules}})
 
-    def __init__(self, yara_rule_dir: Optional[str] = None, *args, **kwargs) -> None:
+    def __init__(self, *args, **kwargs) -> None:
         super().__init__(*args, **kwargs)
-        self.yara_handler = YaraHandler(path=yara_rule_dir or "rules")
+        self.yara_handler = YaraHandler(
+            path=self.config.get("yaramatcher", "rules", fallback="rules")
+        )
 
     def scan_sample(self, sample: bytes) -> List[str]:
         # Get all matches for this sample
         matches = self.yara_handler.get_matches(sample)
         rule_names = []
         for match in matches:
             rule_names.append("yara:{}".format(normalize_rule_name(match.rule)))
```

## Comparing `karton_yaramatcher-1.2.0-nspkg.pth` & `karton_yaramatcher-1.3.0-nspkg.pth`

 * *Files identical despite different names*

## Comparing `karton_yaramatcher-1.2.0.dist-info/LICENSE` & `karton_yaramatcher-1.3.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `karton_yaramatcher-1.2.0.dist-info/METADATA` & `karton_yaramatcher-1.3.0.dist-info/METADATA`

 * *Files 11% similar despite different names*

```diff
@@ -1,27 +1,28 @@
 Metadata-Version: 2.1
 Name: karton-yaramatcher
-Version: 1.2.0
+Version: 1.3.0
 Summary: File and analysis artifacts yara matcher for Karton framework
 Home-page: https://github.com/CERT-Polska/karton-yaramatcher/
 License: UNKNOWN
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Operating System :: OS Independent
 Description-Content-Type: text/markdown
+License-File: LICENSE
 Requires-Dist: karton-core (<6.0.0,>=5.0.0)
 Requires-Dist: yara-python (>=4.0.2)
 
 # YaraMatcher karton service
 
 Scans analyses and samples with yara rules and spawns tasks with appropiate tags.
 
 **Author**: CERT.pl
 
-**Maintainers**: msm, nazywam
+**Maintainers**: nazywam
 
 **Consumes:**
 ```json
 {
     "type": "sample",
     "stage": "recognized",
     "kind": "runnable"
```

## Comparing `karton_yaramatcher-1.2.0.dist-info/RECORD` & `karton_yaramatcher-1.3.0.dist-info/RECORD`

 * *Files 18% similar despite different names*

```diff
@@ -1,12 +1,12 @@
-karton_yaramatcher-1.2.0-nspkg.pth,sha256=vHa-jm6pBTeInFrmnsHMg9AOeD88czzQy-6QCFbpRcM,539
+karton_yaramatcher-1.3.0-nspkg.pth,sha256=vHa-jm6pBTeInFrmnsHMg9AOeD88czzQy-6QCFbpRcM,539
 karton/yaramatcher/__init__.py,sha256=jYGYCqU2XaDpnvjrrDE3tq-oOXMRmeSanow3ceSTI04,79
 karton/yaramatcher/__main__.py,sha256=nhiwr9SWVL-dc1oVKTMuTpA793l4Ew5xl1qrLluSEYE,57
-karton/yaramatcher/__version__.py,sha256=MpAT5hgNoHnTtG1XRD_GV_A7QrHVU6vJjGSw_8qMGA4,22
-karton/yaramatcher/yaramatcher.py,sha256=_PX4jfOrR9lXCpi0EtbuWJgJfQ4UhOFdA3-LmyG_br4,7836
-karton_yaramatcher-1.2.0.dist-info/LICENSE,sha256=o8h7hYhn7BJC_-DmrfqWwLjaR_Gbe0TZOOQJuN2ca3I,1519
-karton_yaramatcher-1.2.0.dist-info/METADATA,sha256=wHVuD_yYYIk4DkzV33zgG4DoTxtoMjH0dlSYtjCYhMM,1542
-karton_yaramatcher-1.2.0.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
-karton_yaramatcher-1.2.0.dist-info/entry_points.txt,sha256=mM-Wv4TVGzR0pl4jj7UA_t-zeb5rgQ16mBL--4VBTYM,76
-karton_yaramatcher-1.2.0.dist-info/namespace_packages.txt,sha256=X8SslCPsqXDCnGZqrYYolzT3xPzJMq1r-ZQSc0jfAEA,7
-karton_yaramatcher-1.2.0.dist-info/top_level.txt,sha256=X8SslCPsqXDCnGZqrYYolzT3xPzJMq1r-ZQSc0jfAEA,7
-karton_yaramatcher-1.2.0.dist-info/RECORD,,
+karton/yaramatcher/__version__.py,sha256=F5mW07pSyGrqDNY2Ehr-UpDzpBtN-FsYU0QGZWf6PJE,22
+karton/yaramatcher/yaramatcher.py,sha256=GIG78j57sH6esXPBG6FMDevz7gYUYlB2lFgafZ4BMXw,7799
+karton_yaramatcher-1.3.0.dist-info/LICENSE,sha256=o8h7hYhn7BJC_-DmrfqWwLjaR_Gbe0TZOOQJuN2ca3I,1519
+karton_yaramatcher-1.3.0.dist-info/METADATA,sha256=bkF7BKU03iJcVgxmAVE8jZjfufIZRFRko3I5dsnnbxE,1559
+karton_yaramatcher-1.3.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+karton_yaramatcher-1.3.0.dist-info/entry_points.txt,sha256=mM-Wv4TVGzR0pl4jj7UA_t-zeb5rgQ16mBL--4VBTYM,76
+karton_yaramatcher-1.3.0.dist-info/namespace_packages.txt,sha256=X8SslCPsqXDCnGZqrYYolzT3xPzJMq1r-ZQSc0jfAEA,7
+karton_yaramatcher-1.3.0.dist-info/top_level.txt,sha256=X8SslCPsqXDCnGZqrYYolzT3xPzJMq1r-ZQSc0jfAEA,7
+karton_yaramatcher-1.3.0.dist-info/RECORD,,
```

