# Comparing `tmp/kaiju_tools-2.1.16-py3-none-any.whl.zip` & `tmp/kaiju_tools-2.1.17-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,55 +1,55 @@
-Zip file size: 100567 bytes, number of entries: 53
--rw-r--r--  2.0 unx      263 b- defN 23-Jul-19 10:50 kaiju_tools/__init__.py
--rw-r--r--  2.0 unx    15156 b- defN 23-Jul-19 10:50 kaiju_tools/annotations.py
--rw-r--r--  2.0 unx    36691 b- defN 23-Jul-19 10:50 kaiju_tools/app.py
--rw-r--r--  2.0 unx     4459 b- defN 23-Jul-19 10:50 kaiju_tools/cache.py
--rw-r--r--  2.0 unx      378 b- defN 23-Jul-19 10:50 kaiju_tools/context_vars.py
--rw-r--r--  2.0 unx     9984 b- defN 23-Jul-19 10:50 kaiju_tools/encoding.py
--rw-r--r--  2.0 unx     5653 b- defN 23-Jul-19 10:50 kaiju_tools/exceptions.py
--rw-r--r--  2.0 unx     8707 b- defN 23-Jul-19 10:50 kaiju_tools/functions.py
--rw-r--r--  2.0 unx     8944 b- defN 23-Jul-19 10:50 kaiju_tools/http.py
--rw-r--r--  2.0 unx    11500 b- defN 23-Jul-19 10:50 kaiju_tools/interfaces.py
--rw-r--r--  2.0 unx    10820 b- defN 23-Jul-19 10:50 kaiju_tools/jsonschema.py
--rw-r--r--  2.0 unx     7372 b- defN 23-Jul-19 10:50 kaiju_tools/locks.py
--rw-r--r--  2.0 unx    10830 b- defN 23-Jul-19 10:50 kaiju_tools/logging.py
--rw-r--r--  2.0 unx     7839 b- defN 23-Jul-19 10:50 kaiju_tools/mapping.py
--rw-r--r--  2.0 unx    11183 b- defN 23-Jul-19 10:50 kaiju_tools/registry.py
--rw-r--r--  2.0 unx    35330 b- defN 23-Jul-19 10:50 kaiju_tools/rpc.py
--rw-r--r--  2.0 unx     4418 b- defN 23-Jul-19 10:50 kaiju_tools/rpc_client_gen.py
--rw-r--r--  2.0 unx      655 b- defN 23-Jul-19 10:50 kaiju_tools/services.py
--rw-r--r--  2.0 unx    18251 b- defN 23-Jul-19 10:50 kaiju_tools/sessions.py
--rw-r--r--  2.0 unx     9496 b- defN 23-Jul-19 10:50 kaiju_tools/streams.py
--rw-r--r--  2.0 unx    14496 b- defN 23-Jul-19 10:50 kaiju_tools/templates.py
--rw-r--r--  2.0 unx    12721 b- defN 23-Jul-19 10:50 kaiju_tools/types.py
--rw-r--r--  2.0 unx      103 b- defN 23-Jul-19 10:50 kaiju_tools/docker/__init__.py
--rw-r--r--  2.0 unx     9786 b- defN 23-Jul-19 10:50 kaiju_tools/docker/containers.py
--rw-r--r--  2.0 unx     7727 b- defN 23-Jul-19 10:50 kaiju_tools/docker/images.py
--rw-r--r--  2.0 unx    11217 b- defN 23-Jul-19 10:50 kaiju_tools/docker/stack.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jul-19 10:50 kaiju_tools/docker/tests/__init__.py
--rw-r--r--  2.0 unx     1306 b- defN 23-Jul-19 10:50 kaiju_tools/docker/tests/fixtures.py
--rw-r--r--  2.0 unx      575 b- defN 23-Jul-19 10:50 kaiju_tools/docker/tests/test_containers.py
--rw-r--r--  2.0 unx      359 b- defN 23-Jul-19 10:50 kaiju_tools/docker/tests/test_images.py
--rw-r--r--  2.0 unx      371 b- defN 23-Jul-19 10:50 kaiju_tools/docker/tests/test_stack.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jul-19 10:50 kaiju_tools/tests/__init__.py
--rw-r--r--  2.0 unx    20566 b- defN 23-Jul-19 10:50 kaiju_tools/tests/fixtures.py
--rw-r--r--  2.0 unx     9209 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_annotation_parser.py
--rw-r--r--  2.0 unx     1531 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_cache.py
--rw-r--r--  2.0 unx     1386 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_class_registry.py
--rw-r--r--  2.0 unx      552 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_configurator.py
--rw-r--r--  2.0 unx     3069 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_data_store.py
--rw-r--r--  2.0 unx     3139 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_http.py
--rw-r--r--  2.0 unx     2232 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_jsonschema.py
--rw-r--r--  2.0 unx     2210 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_locks.py
--rw-r--r--  2.0 unx     3457 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_mapping.py
--rw-r--r--  2.0 unx     8466 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_rpc.py
--rw-r--r--  2.0 unx     1554 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_scheduler.py
--rw-r--r--  2.0 unx     2474 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_serializers.py
--rw-r--r--  2.0 unx     2207 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_services.py
--rw-r--r--  2.0 unx     3221 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_streams.py
--rw-r--r--  2.0 unx     1692 b- defN 23-Jul-19 10:50 kaiju_tools/tests/test_templates.py
--rw-rw-rw-  2.0 unx      610 b- defN 23-Jul-19 10:50 kaiju_tools-2.1.16.dist-info/LICENSE
--rw-r--r--  2.0 unx     3365 b- defN 23-Jul-19 10:50 kaiju_tools-2.1.16.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-19 10:50 kaiju_tools-2.1.16.dist-info/WHEEL
--rw-r--r--  2.0 unx       12 b- defN 23-Jul-19 10:50 kaiju_tools-2.1.16.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4533 b- defN 23-Jul-19 10:50 kaiju_tools-2.1.16.dist-info/RECORD
-53 files, 352167 bytes uncompressed, 93371 bytes compressed:  73.5%
+Zip file size: 100732 bytes, number of entries: 53
+-rw-r--r--  2.0 unx      263 b- defN 23-Jul-27 19:27 kaiju_tools/__init__.py
+-rw-r--r--  2.0 unx    15156 b- defN 23-Jul-27 19:27 kaiju_tools/annotations.py
+-rw-r--r--  2.0 unx    36848 b- defN 23-Jul-27 19:27 kaiju_tools/app.py
+-rw-r--r--  2.0 unx     4459 b- defN 23-Jul-27 19:27 kaiju_tools/cache.py
+-rw-r--r--  2.0 unx      378 b- defN 23-Jul-27 19:27 kaiju_tools/context_vars.py
+-rw-r--r--  2.0 unx     9984 b- defN 23-Jul-27 19:27 kaiju_tools/encoding.py
+-rw-r--r--  2.0 unx     5653 b- defN 23-Jul-27 19:27 kaiju_tools/exceptions.py
+-rw-r--r--  2.0 unx     8707 b- defN 23-Jul-27 19:27 kaiju_tools/functions.py
+-rw-r--r--  2.0 unx     8944 b- defN 23-Jul-27 19:27 kaiju_tools/http.py
+-rw-r--r--  2.0 unx    11500 b- defN 23-Jul-27 19:27 kaiju_tools/interfaces.py
+-rw-r--r--  2.0 unx    10820 b- defN 23-Jul-27 19:27 kaiju_tools/jsonschema.py
+-rw-r--r--  2.0 unx     7372 b- defN 23-Jul-27 19:27 kaiju_tools/locks.py
+-rw-r--r--  2.0 unx    10830 b- defN 23-Jul-27 19:27 kaiju_tools/logging.py
+-rw-r--r--  2.0 unx     7839 b- defN 23-Jul-27 19:27 kaiju_tools/mapping.py
+-rw-r--r--  2.0 unx    11183 b- defN 23-Jul-27 19:27 kaiju_tools/registry.py
+-rw-r--r--  2.0 unx    35648 b- defN 23-Jul-27 19:27 kaiju_tools/rpc.py
+-rw-r--r--  2.0 unx     4418 b- defN 23-Jul-27 19:27 kaiju_tools/rpc_client_gen.py
+-rw-r--r--  2.0 unx      655 b- defN 23-Jul-27 19:27 kaiju_tools/services.py
+-rw-r--r--  2.0 unx    18251 b- defN 23-Jul-27 19:27 kaiju_tools/sessions.py
+-rw-r--r--  2.0 unx     9496 b- defN 23-Jul-27 19:27 kaiju_tools/streams.py
+-rw-r--r--  2.0 unx    14496 b- defN 23-Jul-27 19:27 kaiju_tools/templates.py
+-rw-r--r--  2.0 unx    12721 b- defN 23-Jul-27 19:27 kaiju_tools/types.py
+-rw-r--r--  2.0 unx      103 b- defN 23-Jul-27 19:27 kaiju_tools/docker/__init__.py
+-rw-r--r--  2.0 unx     9786 b- defN 23-Jul-27 19:27 kaiju_tools/docker/containers.py
+-rw-r--r--  2.0 unx     7727 b- defN 23-Jul-27 19:27 kaiju_tools/docker/images.py
+-rw-r--r--  2.0 unx    11217 b- defN 23-Jul-27 19:27 kaiju_tools/docker/stack.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jul-27 19:27 kaiju_tools/docker/tests/__init__.py
+-rw-r--r--  2.0 unx     1306 b- defN 23-Jul-27 19:27 kaiju_tools/docker/tests/fixtures.py
+-rw-r--r--  2.0 unx      575 b- defN 23-Jul-27 19:27 kaiju_tools/docker/tests/test_containers.py
+-rw-r--r--  2.0 unx      359 b- defN 23-Jul-27 19:27 kaiju_tools/docker/tests/test_images.py
+-rw-r--r--  2.0 unx      371 b- defN 23-Jul-27 19:27 kaiju_tools/docker/tests/test_stack.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jul-27 19:27 kaiju_tools/tests/__init__.py
+-rw-r--r--  2.0 unx    20743 b- defN 23-Jul-27 19:27 kaiju_tools/tests/fixtures.py
+-rw-r--r--  2.0 unx     9209 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_annotation_parser.py
+-rw-r--r--  2.0 unx     1531 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_cache.py
+-rw-r--r--  2.0 unx     1386 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_class_registry.py
+-rw-r--r--  2.0 unx      552 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_configurator.py
+-rw-r--r--  2.0 unx     3069 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_data_store.py
+-rw-r--r--  2.0 unx     3139 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_http.py
+-rw-r--r--  2.0 unx     2232 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_jsonschema.py
+-rw-r--r--  2.0 unx     2210 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_locks.py
+-rw-r--r--  2.0 unx     3457 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_mapping.py
+-rw-r--r--  2.0 unx     8498 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_rpc.py
+-rw-r--r--  2.0 unx     1554 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_scheduler.py
+-rw-r--r--  2.0 unx     2474 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_serializers.py
+-rw-r--r--  2.0 unx     2207 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_services.py
+-rw-r--r--  2.0 unx     3221 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_streams.py
+-rw-r--r--  2.0 unx     1692 b- defN 23-Jul-27 19:27 kaiju_tools/tests/test_templates.py
+-rw-rw-rw-  2.0 unx      610 b- defN 23-Jul-27 19:27 kaiju_tools-2.1.17.dist-info/LICENSE
+-rw-r--r--  2.0 unx     3413 b- defN 23-Jul-27 19:27 kaiju_tools-2.1.17.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-27 19:27 kaiju_tools-2.1.17.dist-info/WHEEL
+-rw-r--r--  2.0 unx       12 b- defN 23-Jul-27 19:27 kaiju_tools-2.1.17.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4533 b- defN 23-Jul-27 19:27 kaiju_tools-2.1.17.dist-info/RECORD
+53 files, 352899 bytes uncompressed, 93536 bytes compressed:  73.5%
```

## zipnote {}

```diff
@@ -138,23 +138,23 @@
 
 Filename: kaiju_tools/tests/test_streams.py
 Comment: 
 
 Filename: kaiju_tools/tests/test_templates.py
 Comment: 
 
-Filename: kaiju_tools-2.1.16.dist-info/LICENSE
+Filename: kaiju_tools-2.1.17.dist-info/LICENSE
 Comment: 
 
-Filename: kaiju_tools-2.1.16.dist-info/METADATA
+Filename: kaiju_tools-2.1.17.dist-info/METADATA
 Comment: 
 
-Filename: kaiju_tools-2.1.16.dist-info/WHEEL
+Filename: kaiju_tools-2.1.17.dist-info/WHEEL
 Comment: 
 
-Filename: kaiju_tools-2.1.16.dist-info/top_level.txt
+Filename: kaiju_tools-2.1.17.dist-info/top_level.txt
 Comment: 
 
-Filename: kaiju_tools-2.1.16.dist-info/RECORD
+Filename: kaiju_tools-2.1.17.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## kaiju_tools/__init__.py

```diff
@@ -1,9 +1,9 @@
 from kaiju_tools.types import *
 from kaiju_tools.app import *
 from kaiju_tools.encoding import Serializable
 from kaiju_tools.http import *
 from kaiju_tools.interfaces import *
 
-__version__ = '2.1.16'
+__version__ = '2.1.17'
 __python_version__ = '3.8'
 __author__ = 'antonnidhoggr@me.com'
```

## kaiju_tools/app.py

```diff
@@ -10,15 +10,15 @@
 from argparse import ArgumentParser
 from ast import literal_eval
 from collections.abc import Awaitable, Callable, Collection, Iterable
 from contextvars import ContextVar  # noqa: pycharm
 from enum import Enum
 from functools import partial
 from time import time
-from typing import List, NewType, Optional, Tuple, Type, TypedDict, TypeVar, Union, cast
+from typing import NewType, TypedDict, TypeVar, Union, cast
 from warnings import warn
 from weakref import proxy
 
 import yaml
 from aiohttp.web import Application, AppRunner, run_app
 
 import kaiju_tools.jsonschema as js
@@ -1058,25 +1058,30 @@
 
 
 def run_server(
     init_app_func=init_app,
     base_config_paths: Collection[str] = None,
     base_env_paths: Collection[str] = None,
     default_env_paths: Collection[str] = None,
+    enable_loader_logs: bool = True,
 ) -> None:
     """Run aiohttp server or command.
 
     You should use this in the `__main__` section of the project to start the app.
 
     :param init_app_func: app initialization function
     :param base_config_paths: list of base paths to .yml config files in sequential order
     :param base_env_paths: list of base paths to .env files in sequential order
     :param default_env_paths: list of paths to .env files which may be overriden by the `--env-file` flag
+    :param enable_loader_logs: enable logs for the config loader
     """
-    logging.basicConfig(level='INFO')  # to be able to log config loader
+    if enable_loader_logs:
+        logging.basicConfig(level='INFO')  # to be able to log config loader
+    else:
+        logging.basicConfig(level='FATAL')
     config_loader = ConfigLoader(
         base_config_paths=base_config_paths, base_env_paths=base_env_paths, default_env_paths=default_env_paths
     )
     command, config = config_loader.configure()
     logging.root.handlers = []
     app: App = init_app_func(config)
     if config.app.debug:
```

## kaiju_tools/rpc.py

```diff
@@ -137,14 +137,15 @@
 class MethodInfo(TypedDict):
     """Stored method data."""
 
     f: Callable
     args: frozenset
     kws: frozenset
     keys: frozenset
+    variable_args: bool
     signature: FunctionAnnotation
     service_name: str
     permission: Scope
     validator: Callable
 
 
 _correlation_id = JSONRPCHeaders.CORRELATION_ID_HEADER
@@ -351,25 +352,31 @@
                 if params:
                     params = params.repr()
                     if params:
                         validator = compile_schema(params)
 
             sig = inspect.signature(f)
             args, kws = set(), set()
+            variable = False
             for key in sig.parameters.values():
-                if key.default is key.empty:
+                if key.kind == key.VAR_KEYWORD:
+                    variable = True
+                elif key.kind == key.VAR_POSITIONAL:
+                    continue
+                elif key.default is key.empty:
                     args.add(key.name)
                 else:
                     kws.add(key.name)
             keys = args | kws
             method = MethodInfo(
                 f=f,
                 args=frozenset(args),
                 kws=frozenset(kws),
                 keys=frozenset(keys),
+                variable_args=variable,
                 permission=self._permission_levels[route_perm],
                 validator=validator,
                 service_name=service_name,
                 signature=annotation,
             )
             self._methods[full_name] = method
 
@@ -688,15 +695,17 @@
             _params = {}
         if not use_template and _method['validator']:
             try:
                 _params = _method['validator'](_params)
             except Exception as exc:
                 raise InvalidParams(id=_id, message=str(exc), base_exc=exc) from None
 
-        if not _method['keys'].issuperset(_params) or not _method['args'].issubset(_params):
+        if not _method['variable_args'] and (
+            not _method['keys'].issuperset(_params) or not _method['args'].issubset(_params)
+        ):
             raise InvalidParams(
                 id=_id,
                 message='Invalid params',
                 required_args=_method['args'],
                 optional_args=_method['kws'],
                 provided_args=list(_params),
             ) from None
```

## kaiju_tools/tests/fixtures.py

```diff
@@ -1,13 +1,14 @@
 import asyncio
 import logging
 import uuid
 from datetime import datetime
 from time import time
-from typing import cast, Dict, List, FrozenSet, Optional, Collection, Hashable, Type, AsyncGenerator, Union
+from typing import cast, Dict, List, FrozenSet, Optional, Type, Union
+from collections.abc import Collection, Hashable, AsyncGenerator
 
 import pytest  # noqa: pycharm
 import pytest_asyncio
 
 import kaiju_tools.jsonschema as js
 from kaiju_tools.exceptions import ValidationError, NotFound
 from kaiju_tools.app import (
@@ -111,36 +112,36 @@
 def rpc(app, scheduler) -> JSONRPCServer:
     service = JSONRPCServer(app=app, scheduler=scheduler, request_logs=True, response_logs=True)
     app.services.add_service(service)
     return service
 
 
 class _MockDataStore(Service, DataStore):
-    def __init__(self, *args, primary_key: Union[str, List[str]] = 'id', **kws):
+    def __init__(self, *args, primary_key: str | list[str] = 'id', **kws):
         super().__init__(*args, **kws)
         self.primary_key = primary_key
         self._ext = {}
 
     def _get_primary_key(self, row: dict):
         if type(self.primary_key) is str:
             return row[self.primary_key]
         else:
             return tuple(row[key] for key in self.primary_key)
 
     @staticmethod
-    def _filter_columns(row: dict, columns) -> Optional[dict]:
+    def _filter_columns(row: dict, columns) -> dict | None:
         if not columns:
             return
         elif columns == '*':
             return row
         else:
             return {key: row[key] for key in row if key in columns}
 
     @staticmethod
-    def _check_condition(row: dict, conditions: Optional[Condition]) -> bool:
+    def _check_condition(row: dict, conditions: Condition | None) -> bool:
         return conditions(row) if conditions else True
 
     async def get(self, id: Hashable, columns: _Columns = '*', _connection=None):
         await asyncio.sleep(0)
         try:
             row = self._ext[id]
         except KeyError:
@@ -153,15 +154,15 @@
         rows = [self._ext.get(key) for key in id if key in self._ext]
         return [self._filter_columns(row, columns) for row in rows]
 
     async def exists(self, id: Hashable, _connection=None) -> bool:
         await asyncio.sleep(0)
         return id in self._ext
 
-    async def m_exists(self, id: Collection[Hashable], _connection=None) -> FrozenSet[Hashable]:
+    async def m_exists(self, id: Collection[Hashable], _connection=None) -> frozenset[Hashable]:
         await asyncio.sleep(0)
         return frozenset(key for key in id if key in self._ext)
 
     async def delete(self, id: Hashable, columns: _Columns = None, _connection=None):
         await asyncio.sleep(0)
         try:
             row = self._ext.pop(id)
@@ -239,15 +240,15 @@
                 row = self._ext[key]
                 rows.append(self._filter_columns(row, columns))
         if columns:
             return rows
 
     async def iter(
         self, conditions: dict = None, sort=None, offset: int = 0, limit: int = 10, columns: _Columns = '*'
-    ) -> AsyncGenerator[List[dict], None]:
+    ) -> AsyncGenerator[list[dict], None]:
         if conditions:
             conditions = Condition(conditions)
         rows = [
             self._filter_columns(row, columns) for row in self._ext.values() if self._check_condition(row, conditions)
         ][offset:]
         for _offset in range(0, (len(rows) // limit) + 1):
             chunk = rows[_offset * limit : (_offset + 1) * limit]
@@ -267,33 +268,33 @@
         pass
 
     def __init__(self, *args, **kws):
         super().__init__(*args, **kws)
         self._ext = TTLDict()
 
     @classmethod
-    def get_transport_cls(cls) -> Type:
+    def get_transport_cls(cls) -> type:
         return cls.MockTransport
 
     async def exists(self, id: NSKey) -> bool:
         return id in self._ext
 
     async def m_exists(self, id: NSKey):
         return frozenset([key for key in id if key in self._ext])
 
     async def _get(self, key: NSKey):
         return self._ext.get(key)
 
-    async def _m_get(self, *keys: NSKey) -> List[NSKey]:
+    async def _m_get(self, *keys: NSKey) -> list[NSKey]:
         return [self._ext.get(key) for key in keys]
 
     async def _set(self, key: NSKey, value: bytes, ttl: int):
         self._ext.set(key, value, ttl)
 
-    async def _m_set(self, keys: Dict[NSKey, bytes], ttl: int):
+    async def _m_set(self, keys: dict[NSKey, bytes], ttl: int):
         for key, value in keys.items():
             self._ext.set(key, value, ttl)
 
     async def _delete(self, key: str):
         if key in self._ext:
             del self._ext[key]
 
@@ -345,22 +346,22 @@
     def __init__(self, *args, session: Session, **kws):
         super().__init__(*args, **kws)
         self.token = uuid.uuid4().hex
         self.refresh_token = uuid.uuid4().hex
         self.user_id = session.user_id
         self.permissions = session.permissions
 
-    async def auth(self, token: str, /) -> Optional[TokenInterface.TokenClaims]:
+    async def auth(self, token: str, /) -> TokenInterface.TokenClaims | None:
         if token == self.token:
             return TokenInterface.TokenClaims(id=self.user_id, permissions=self.permissions)
 
     async def get(self, claims: TokenInterface.TokenClaims, /) -> TokenInterface.TokenInfo:
         return TokenInterface.TokenInfo(access=self.token, refresh=self.refresh_token)
 
-    async def refresh(self, token: str, /) -> Optional[TokenInterface.TokenInfo]:
+    async def refresh(self, token: str, /) -> TokenInterface.TokenInfo | None:
         if token == self.refresh_token:
             return TokenInterface.TokenInfo(access=self.token, refresh=self.refresh_token)
 
 
 @pytest.fixture
 def mock_tokens(app, mock_session) -> TokenInterface:  # noqa: pycharm
     service = _MockTokenService(app=app, session=mock_session)
@@ -384,15 +385,15 @@
             'permissions': frozenset({'user'}),
             'settings': self.profile,
         }
 
     async def get_user_and_permissions(self, id: uuid.UUID):
         return self.get_user()
 
-    async def auth(self, username: str, password: str) -> Optional[_User]:
+    async def auth(self, username: str, password: str) -> _User | None:
         if username == self.username and password == self.password:
             return TokenInterface.TokenClaims(id=self.session.user_id, permissions=self.session.permissions)
 
     async def register(self, username: str, email: str, password: str, settings: dict = None) -> _User:
         self.username = username
         self.password = password
         return self.get_user()
@@ -441,36 +442,36 @@
         pass
 
     def __init__(self, *args, **kws):
         super().__init__(*args, **kws)
         self._ext = TTLDict()
 
     @classmethod
-    def get_transport_cls(cls) -> Type:
+    def get_transport_cls(cls) -> type:
         return cls.MockTransport
 
-    async def m_exists(self, keys: List[NSKey]) -> FrozenSet[NSKey]:
+    async def m_exists(self, keys: list[NSKey]) -> frozenset[NSKey]:
         s = frozenset(key for key in keys if key in self._ext)
         return s
 
-    async def _acquire(self, keys: List[NSKey], identifier, ttl: int):
+    async def _acquire(self, keys: list[NSKey], identifier, ttl: int):
         for key in keys:
             if key in self._ext:
                 raise LockExistsError(key)
         for key in keys:
             self._ext.set(key, identifier, ttl=ttl)
 
-    async def _release(self, keys: List[NSKey], identifier) -> None:
+    async def _release(self, keys: list[NSKey], identifier) -> None:
         for key in keys:
             existing = self._ext.get(key)
             if existing and existing != identifier:
                 raise NotLockOwnerError()
             del self._ext[key]
 
-    async def _renew(self, keys: List[NSKey], values: List[int]) -> None:
+    async def _renew(self, keys: list[NSKey], values: list[int]) -> None:
         for key, ttl in zip(keys, values):
             existing = self._ext.get(key)
             if existing:
                 self._ext.set(key, existing, ttl=ttl)
 
     async def _owner(self, key: NSKey):
         return self._ext.get(key)
@@ -494,14 +495,15 @@
         self.stored = None
 
     @property
     def routes(self) -> dict:
         return {
             'guest': self.guest,
             'echo': self.echo,
+            'echo_var_args': self.echo_var_args,
             'echo_validated': self.echo_validated,
             'echo_custom_validated': self.echo_custom_validated,
             'echo_user': self.echo_user,
             'echo_session': self.echo_session,
             'write_session': self.write_session,
             'call_system_method': self.call_system_method,
             'fail': self.fail,
@@ -535,14 +537,19 @@
 
     @staticmethod
     async def echo(data=None, t: float = 0):
         await asyncio.sleep(t)
         return data
 
     @staticmethod
+    async def echo_var_args(data=None, **kws):
+        await asyncio.sleep(0)
+        return data, kws
+
+    @staticmethod
     async def fail():
         raise RuntimeError('Destined to fail!')
 
     async def retry(self, n: int = 0):
         self.retry_counter += 1
         if self.retry_counter >= n:
             self.retry_counter = 0
@@ -601,15 +608,15 @@
 class _MockListener(Listener):
     _transport: _MockStream
 
     async def close(self):
         await self._transport.get_stream(self._key).join()
         await super().close()
 
-    def get_transport(self) -> Type:
+    def get_transport(self) -> type:
         return self.discover_service(self._transport, cls=_MockStream)
 
     async def _read_batch(self) -> list:
         msg = await self._transport.get_stream(self._key).get()
         self.logger.debug('read')
         return [msg]
```

## kaiju_tools/tests/test_rpc.py

```diff
@@ -35,31 +35,25 @@
         [
             (True, {'jsonrpc': '2.0', 'id': 421, 'method': 'do.echo', 'params': {'data': True}}),
             (True, {'id': 421, 'method': 'do.echo', 'params': {'data': True}}),
             (True, {'method': 'do.echo', 'params': {'data': True}}),
             (None, {'method': 'do.echo'}),
             (None, {'method': 'do.echo', 'params': None}),
             ('mock_session', {'method': 'do.echo_session'}),
+            ((None, {'a': True}), {'method': 'do.echo_var_args', 'params': {'a': True}}),
         ],
-        ids=[
-            'normal',
-            'no protocol',
-            'default id',
-            'no params',
-            'null params',
-            'session context',
-        ],
+        ids=['normal', 'no protocol', 'default id', 'no params', 'null params', 'session context', 'variable args'],
     )
     async def test_valid_calls(self, _rpc: JSONRPCServer, mock_session, req, result):
         req_headers = {JSONRPCHeaders.CORRELATION_ID_HEADER: 'ffffffff'}
         headers, response = await _rpc.call(req, req_headers, session_id=mock_session.id)
         assert headers[JSONRPCHeaders.CORRELATION_ID_HEADER] == req_headers[JSONRPCHeaders.CORRELATION_ID_HEADER]
         assert response['result'] == result
 
-    async def test_retries(self, _rpc: JSONRPCServer, mock_session):
+    async def test_retries(self, _rpc: JSONRPCServer, mock_session, logger):
         req_headers = {JSONRPCHeaders.RETRIES: 3}
         req = {'method': 'do.retry', 'params': {'n': 3}}
         headers, response = await _rpc.call(req, req_headers, session_id=mock_session.id)
         assert response['result'] is True
 
     async def test_local_callback(self, _rpc: JSONRPCServer, mock_session):
         counter = 0
```

## Comparing `kaiju_tools-2.1.16.dist-info/LICENSE` & `kaiju_tools-2.1.17.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `kaiju_tools-2.1.16.dist-info/METADATA` & `kaiju_tools-2.1.17.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: kaiju-tools
-Version: 2.1.16
+Version: 2.1.17
 Summary: Base classes and services for a backend application.
 Home-page: https://gitlab.com/kaiju-python/kaiju-tools
 Author: antonnidhoggr@me.com
 Author-email: antonnidhoggr@me.com
 License: Apache Software License 2.0
 Classifier: Development Status :: 3 - Alpha
 Classifier: License :: OSI Approved :: Apache Software License
@@ -38,14 +38,15 @@
 Requires-Dist: restructuredtext-lint (>=1.4) ; extra == 'dev'
 Requires-Dist: tox (>=3.28) ; extra == 'dev'
 Requires-Dist: tox-pyenv (>=1.1) ; extra == 'dev'
 Requires-Dist: pip-tools (>=6.13) ; extra == 'dev'
 Requires-Dist: pyupgrade (>=3.4) ; extra == 'dev'
 Requires-Dist: towncrier (>=23.6) ; extra == 'dev'
 Requires-Dist: isort (>=5.12.0) ; extra == 'dev'
+Requires-Dist: xenon (>=0.9.0) ; extra == 'dev'
 Provides-Extra: docs
 Requires-Dist: sphinx ; extra == 'docs'
 Requires-Dist: python-docs-theme ; extra == 'docs'
 Provides-Extra: test
 Requires-Dist: pytest (>=7.4) ; extra == 'test'
 Requires-Dist: pytest-asyncio (>=0.21) ; extra == 'test'
 Requires-Dist: docker (>=6.1.3) ; extra == 'test'
```

## Comparing `kaiju_tools-2.1.16.dist-info/RECORD` & `kaiju_tools-2.1.17.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,23 +1,23 @@
-kaiju_tools/__init__.py,sha256=vcmPuOwEjkBg2zqcYuZwPKHtKfQy8XLEikKQ-pPNtrk,263
+kaiju_tools/__init__.py,sha256=X03qqA2zD9GGxa8JTS1A_y47VCLq7TUJetKYVHpJyIk,263
 kaiju_tools/annotations.py,sha256=fHFg6KdxPA4_dYmwQd8pYD_0-ejIiiwUv8b3--TREy0,15156
-kaiju_tools/app.py,sha256=Pb6BFtGU7melYsAo4di6jz_wWwbsuc77CH40GoSlMXg,36691
+kaiju_tools/app.py,sha256=RPOceQKxDJ8z9WT8FlUG0sjV8T06CTrt3aoY_o3WetM,36848
 kaiju_tools/cache.py,sha256=WBnRRtq0pKk7zUQW7EtXYr1jTZl33txcViCXfozlJ38,4459
 kaiju_tools/context_vars.py,sha256=55COmTnOtSHh8mIBvWNamnJB4AYLyWZciy3SvS1DlmM,378
 kaiju_tools/encoding.py,sha256=0wKpMjZgWbE19dalkCCIsXFVzsFNeQjTGrzJO0nMNfQ,9984
 kaiju_tools/exceptions.py,sha256=u1hhBpL2Ksw847oK0q--hUm9Akp-P2UdDJrERMrhB_M,5653
 kaiju_tools/functions.py,sha256=k4e2Rr5Ml2RmsiiR57PgO1txvgnYx2VXTiw7pJkCWHA,8707
 kaiju_tools/http.py,sha256=__AGENTKHuJ-bgRj2XBYJkPLnLU1rejNc0CgdIiz09o,8944
 kaiju_tools/interfaces.py,sha256=6qY-T_Z7v1ATQDOq7EG0aeveGk2uW-i3zffPTnqX5Ic,11500
 kaiju_tools/jsonschema.py,sha256=M43ByezHmQhwD-c5TQy8T6keoP-bH2bWRnpti2_GNBY,10820
 kaiju_tools/locks.py,sha256=XTxrfUX9ASrYjVdVbz4crOZH0Uj7SZnOTNCh9-gi6jA,7372
 kaiju_tools/logging.py,sha256=HODD0ZexJfUzMLf3nF7MBg8E6x0YYaRTq3z4eAjTv8s,10830
 kaiju_tools/mapping.py,sha256=EaZvuASRC0T6ngdNcKvtbrpJd8zsIHwO4dXTadIQbu0,7839
 kaiju_tools/registry.py,sha256=SqYf0mO_GH9Ng0Hq4RPvHj1FMHl16CPnbaabxXA6Q8U,11183
-kaiju_tools/rpc.py,sha256=plZb0QccRnA022arRYYLj4Y3BtI5HljY9_WmQdvDPmE,35330
+kaiju_tools/rpc.py,sha256=9z3IlRJo3MYO1_T4P6wvwS9dvXjnt-juDyFCXHr9D_E,35648
 kaiju_tools/rpc_client_gen.py,sha256=3X_OhrjFNC6u1Qbo0KGw5NwuNjmGlxgeanfAYiETMbQ,4418
 kaiju_tools/services.py,sha256=xXRiMvBIA4G3_KT-bdrzBqtCSU5-CAai0dOj_8Wcb7Y,655
 kaiju_tools/sessions.py,sha256=R0s2dP0D9nB4dWqXIsejNX_oET7Y1qLqAlpJzxSclLc,18251
 kaiju_tools/streams.py,sha256=zY_Rmk1MxYm7boyZyqIpZDZ4UMpugz3ioH8JHhuT5-8,9496
 kaiju_tools/templates.py,sha256=hsTYBkSE4crw1GJiBzFKBGTS9NuKzwxSJEQed-iCsio,14496
 kaiju_tools/types.py,sha256=RGovFlkx4f_J7JLtHjintqyNoUk_V922QpczNcVizZ0,12721
 kaiju_tools/docker/__init__.py,sha256=cS3Xl3EMOWv0y_WRCi5GKFYXFrcpkievTVSyFUt0p4I,103
@@ -26,28 +26,28 @@
 kaiju_tools/docker/stack.py,sha256=tErrTcIICJ0DcWxX9u2iNw81Wisw1IXxsIzZMxBoJuI,11217
 kaiju_tools/docker/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/docker/tests/fixtures.py,sha256=gbOVIByFFVC4CLAiNQtCW-UqPNCOJ5HgYlvPzJqOlaU,1306
 kaiju_tools/docker/tests/test_containers.py,sha256=Yugtil6wQs2DGp6W0lNJM0ZoihzG5d95z0u5StGIfJ0,575
 kaiju_tools/docker/tests/test_images.py,sha256=XDJ1Z3XQSQswiJxDO_QtKmw4NymJpXhSdvHtxCGg8rE,359
 kaiju_tools/docker/tests/test_stack.py,sha256=qa6UbjCBiVmAORKyWTs9HaArZF0ZLBDZSzGJlc3Bjhs,371
 kaiju_tools/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-kaiju_tools/tests/fixtures.py,sha256=8gYLro9G9P03XvRpaqkgheAF8LBIufXYyTtT2872SHw,20566
+kaiju_tools/tests/fixtures.py,sha256=TazKK5B7klhk84Zyp_69QmwZWhf7FXI7QqMySifP7Qs,20743
 kaiju_tools/tests/test_annotation_parser.py,sha256=jCQ5DR_EJEcyH5L5YzhKGw01_UlUxeiSd2i6zJUqhOU,9209
 kaiju_tools/tests/test_cache.py,sha256=xOnlLt6lPNGKq2NEl5TGFdRcB1zh-WulkWqPte23GXU,1531
 kaiju_tools/tests/test_class_registry.py,sha256=caaZER_TjghEydASjUDDYzjRBL3PNb-6mjWGH6Xy1Qw,1386
 kaiju_tools/tests/test_configurator.py,sha256=BwOmU6H4szzWDpK0JNq1b7Q1mm-yWGwAZ3O200MNLJc,552
 kaiju_tools/tests/test_data_store.py,sha256=3_PCI-oaf6yJNzbOYgI0jyJtO464xJ9AVtU6308D_pY,3069
 kaiju_tools/tests/test_http.py,sha256=_C4E_dIqHPuhbBJOKLNPnWR22Rt2J4ywmzVTi_Cg3yw,3139
 kaiju_tools/tests/test_jsonschema.py,sha256=briHZos250aH5Xi1hI8DimDwUH8nTGTzzEO-E_iJzPU,2232
 kaiju_tools/tests/test_locks.py,sha256=CQhiE7VLr8-dekVEwkHs44OYTX2Hyv-Tmr5Irl1NOWI,2210
 kaiju_tools/tests/test_mapping.py,sha256=tv60gtNz-89RBFw3vYuBD3QWi49FYkYvoOMgRQW74zY,3457
-kaiju_tools/tests/test_rpc.py,sha256=ZS_em2XK_JclcJoUX7eGYGcF23S-yNiZpsEn7GuCPI8,8466
+kaiju_tools/tests/test_rpc.py,sha256=wOP5bC969rFdJXT2fwU9gVAAmS5RhVpkP6JhRI8-zWA,8498
 kaiju_tools/tests/test_scheduler.py,sha256=XA2kHgGUDr_E2XpAQAt4eaWY_rJ1cMxo_AnlntM6r9Y,1554
 kaiju_tools/tests/test_serializers.py,sha256=Zt-blPx4YRgWaqmKscNGm_mWi5VB6f1L9Jr9x3LdV9k,2474
 kaiju_tools/tests/test_services.py,sha256=cCZecNOXsY-j91l07_rG3rfKpXQiu6DeMqBCrbaBsuY,2207
 kaiju_tools/tests/test_streams.py,sha256=62FA7XY9Qg2meDf9hkWTiNoJG2I6HMWLxXHPdc_hBag,3221
 kaiju_tools/tests/test_templates.py,sha256=CoQdRatGZhGzPl_y4MYXPTQMA9c_wn0ieVITQaamrL4,1692
-kaiju_tools-2.1.16.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
-kaiju_tools-2.1.16.dist-info/METADATA,sha256=PlV0vthFHJlrlUA7ui4alUGEg-CEuJ5EIwSkLrBuY9c,3365
-kaiju_tools-2.1.16.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-kaiju_tools-2.1.16.dist-info/top_level.txt,sha256=DIgXUScFnJtRLiRWfjo547JK4rMuTIJoioMPRe1Jn6Y,12
-kaiju_tools-2.1.16.dist-info/RECORD,,
+kaiju_tools-2.1.17.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
+kaiju_tools-2.1.17.dist-info/METADATA,sha256=dQJP0oNOMvTSwbtlcnQzwV-87qHKzMWXpDRYKANs6cE,3413
+kaiju_tools-2.1.17.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
+kaiju_tools-2.1.17.dist-info/top_level.txt,sha256=DIgXUScFnJtRLiRWfjo547JK4rMuTIJoioMPRe1Jn6Y,12
+kaiju_tools-2.1.17.dist-info/RECORD,,
```

