# Comparing `tmp/mwdblib-4.4.0-py3-none-any.whl.zip` & `tmp/mwdblib-4.5.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,46 +1,46 @@
-Zip file size: 43326 bytes, number of entries: 44
--rw-r--r--  2.0 unx      479 b- defN 23-Apr-04 13:45 mwdblib/__init__.py
--rw-r--r--  2.0 unx       22 b- defN 23-Apr-04 13:45 mwdblib/__version__.py
--rw-r--r--  2.0 unx     2375 b- defN 23-Apr-04 13:45 mwdblib/blob.py
--rw-r--r--  2.0 unx     1211 b- defN 23-Apr-04 13:45 mwdblib/comment.py
--rw-r--r--  2.0 unx     1953 b- defN 23-Apr-04 13:45 mwdblib/config.py
--rw-r--r--  2.0 unx    37766 b- defN 23-Apr-04 13:45 mwdblib/core.py
--rw-r--r--  2.0 unx     6538 b- defN 23-Apr-04 13:45 mwdblib/exc.py
--rw-r--r--  2.0 unx     4118 b- defN 23-Apr-04 13:45 mwdblib/file.py
--rw-r--r--  2.0 unx      784 b- defN 23-Apr-04 13:45 mwdblib/karton.py
--rw-r--r--  2.0 unx    14953 b- defN 23-Apr-04 13:45 mwdblib/object.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-04 13:45 mwdblib/py.typed
--rw-r--r--  2.0 unx     2620 b- defN 23-Apr-04 13:45 mwdblib/share.py
--rw-r--r--  2.0 unx     1715 b- defN 23-Apr-04 13:45 mwdblib/util.py
--rw-r--r--  2.0 unx      110 b- defN 23-Apr-04 13:45 mwdblib/api/__init__.py
--rw-r--r--  2.0 unx    14885 b- defN 23-Apr-04 13:45 mwdblib/api/api.py
--rw-r--r--  2.0 unx     9237 b- defN 23-Apr-04 13:45 mwdblib/api/options.py
--rw-r--r--  2.0 unx     1289 b- defN 23-Apr-04 13:45 mwdblib/cli/__init__.py
--rw-r--r--  2.0 unx      512 b- defN 23-Apr-04 13:45 mwdblib/cli/attribute.py
--rw-r--r--  2.0 unx      496 b- defN 23-Apr-04 13:45 mwdblib/cli/comment.py
--rw-r--r--  2.0 unx     1355 b- defN 23-Apr-04 13:45 mwdblib/cli/fetch.py
--rw-r--r--  2.0 unx     3018 b- defN 23-Apr-04 13:45 mwdblib/cli/get.py
--rw-r--r--  2.0 unx      584 b- defN 23-Apr-04 13:45 mwdblib/cli/link.py
--rw-r--r--  2.0 unx     1510 b- defN 23-Apr-04 13:45 mwdblib/cli/list.py
--rw-r--r--  2.0 unx     1630 b- defN 23-Apr-04 13:45 mwdblib/cli/login.py
--rw-r--r--  2.0 unx     1612 b- defN 23-Apr-04 13:45 mwdblib/cli/main.py
--rw-r--r--  2.0 unx      502 b- defN 23-Apr-04 13:45 mwdblib/cli/metakey.py
--rw-r--r--  2.0 unx     1664 b- defN 23-Apr-04 13:45 mwdblib/cli/search.py
--rw-r--r--  2.0 unx      504 b- defN 23-Apr-04 13:45 mwdblib/cli/share.py
--rw-r--r--  2.0 unx     1003 b- defN 23-Apr-04 13:45 mwdblib/cli/tag.py
--rw-r--r--  2.0 unx      960 b- defN 23-Apr-04 13:45 mwdblib/cli/types.py
--rw-r--r--  2.0 unx     3696 b- defN 23-Apr-04 13:45 mwdblib/cli/upload.py
--rw-r--r--  2.0 unx      103 b- defN 23-Apr-04 13:45 mwdblib/cli/formatters/__init__.py
--rw-r--r--  2.0 unx     2156 b- defN 23-Apr-04 13:45 mwdblib/cli/formatters/abstract.py
--rw-r--r--  2.0 unx     2756 b- defN 23-Apr-04 13:45 mwdblib/cli/formatters/attribute.py
--rw-r--r--  2.0 unx     1417 b- defN 23-Apr-04 13:45 mwdblib/cli/formatters/formatters.py
--rw-r--r--  2.0 unx      855 b- defN 23-Apr-04 13:45 mwdblib/cli/formatters/json.py
--rw-r--r--  2.0 unx     1226 b- defN 23-Apr-04 13:45 mwdblib/cli/formatters/short.py
--rw-r--r--  2.0 unx     9036 b- defN 23-Apr-04 13:45 mwdblib/cli/formatters/tabular.py
--rw-r--r--  2.0 unx     1068 b- defN 23-Apr-04 13:45 mwdblib-4.4.0.dist-info/LICENSE
--rw-r--r--  2.0 unx      674 b- defN 23-Apr-04 13:45 mwdblib-4.4.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-04 13:45 mwdblib-4.4.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       49 b- defN 23-Apr-04 13:45 mwdblib-4.4.0.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        8 b- defN 23-Apr-04 13:45 mwdblib-4.4.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3450 b- defN 23-Apr-04 13:45 mwdblib-4.4.0.dist-info/RECORD
-44 files, 141991 bytes uncompressed, 37926 bytes compressed:  73.3%
+Zip file size: 44264 bytes, number of entries: 44
+-rw-r--r--  2.0 unx      479 b- defN 23-Jul-27 15:14 mwdblib/__init__.py
+-rw-r--r--  2.0 unx       22 b- defN 23-Jul-27 15:14 mwdblib/__version__.py
+-rw-r--r--  2.0 unx     2552 b- defN 23-Jul-27 15:14 mwdblib/blob.py
+-rw-r--r--  2.0 unx     1321 b- defN 23-Jul-27 15:14 mwdblib/comment.py
+-rw-r--r--  2.0 unx     2126 b- defN 23-Jul-27 15:14 mwdblib/config.py
+-rw-r--r--  2.0 unx    39599 b- defN 23-Jul-27 15:14 mwdblib/core.py
+-rw-r--r--  2.0 unx     6538 b- defN 23-Jul-27 15:14 mwdblib/exc.py
+-rw-r--r--  2.0 unx     4230 b- defN 23-Jul-27 15:14 mwdblib/file.py
+-rw-r--r--  2.0 unx      873 b- defN 23-Jul-27 15:14 mwdblib/karton.py
+-rw-r--r--  2.0 unx    14953 b- defN 23-Jul-27 15:14 mwdblib/object.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jul-27 15:14 mwdblib/py.typed
+-rw-r--r--  2.0 unx     2620 b- defN 23-Jul-27 15:14 mwdblib/share.py
+-rw-r--r--  2.0 unx     1715 b- defN 23-Jul-27 15:14 mwdblib/util.py
+-rw-r--r--  2.0 unx      110 b- defN 23-Jul-27 15:14 mwdblib/api/__init__.py
+-rw-r--r--  2.0 unx    15174 b- defN 23-Jul-27 15:14 mwdblib/api/api.py
+-rw-r--r--  2.0 unx     9837 b- defN 23-Jul-27 15:14 mwdblib/api/options.py
+-rw-r--r--  2.0 unx     1289 b- defN 23-Jul-27 15:14 mwdblib/cli/__init__.py
+-rw-r--r--  2.0 unx      512 b- defN 23-Jul-27 15:14 mwdblib/cli/attribute.py
+-rw-r--r--  2.0 unx      496 b- defN 23-Jul-27 15:14 mwdblib/cli/comment.py
+-rw-r--r--  2.0 unx     1355 b- defN 23-Jul-27 15:14 mwdblib/cli/fetch.py
+-rw-r--r--  2.0 unx     3018 b- defN 23-Jul-27 15:14 mwdblib/cli/get.py
+-rw-r--r--  2.0 unx      584 b- defN 23-Jul-27 15:14 mwdblib/cli/link.py
+-rw-r--r--  2.0 unx     1510 b- defN 23-Jul-27 15:14 mwdblib/cli/list.py
+-rw-r--r--  2.0 unx     2588 b- defN 23-Jul-27 15:14 mwdblib/cli/login.py
+-rw-r--r--  2.0 unx     1950 b- defN 23-Jul-27 15:14 mwdblib/cli/main.py
+-rw-r--r--  2.0 unx      502 b- defN 23-Jul-27 15:14 mwdblib/cli/metakey.py
+-rw-r--r--  2.0 unx     1664 b- defN 23-Jul-27 15:14 mwdblib/cli/search.py
+-rw-r--r--  2.0 unx      504 b- defN 23-Jul-27 15:14 mwdblib/cli/share.py
+-rw-r--r--  2.0 unx     1003 b- defN 23-Jul-27 15:14 mwdblib/cli/tag.py
+-rw-r--r--  2.0 unx      960 b- defN 23-Jul-27 15:14 mwdblib/cli/types.py
+-rw-r--r--  2.0 unx     3696 b- defN 23-Jul-27 15:14 mwdblib/cli/upload.py
+-rw-r--r--  2.0 unx      103 b- defN 23-Jul-27 15:14 mwdblib/cli/formatters/__init__.py
+-rw-r--r--  2.0 unx     2156 b- defN 23-Jul-27 15:14 mwdblib/cli/formatters/abstract.py
+-rw-r--r--  2.0 unx     2756 b- defN 23-Jul-27 15:14 mwdblib/cli/formatters/attribute.py
+-rw-r--r--  2.0 unx     1417 b- defN 23-Jul-27 15:14 mwdblib/cli/formatters/formatters.py
+-rw-r--r--  2.0 unx      855 b- defN 23-Jul-27 15:14 mwdblib/cli/formatters/json.py
+-rw-r--r--  2.0 unx     1226 b- defN 23-Jul-27 15:14 mwdblib/cli/formatters/short.py
+-rw-r--r--  2.0 unx     9036 b- defN 23-Jul-27 15:14 mwdblib/cli/formatters/tabular.py
+-rw-r--r--  2.0 unx     1068 b- defN 23-Jul-27 15:14 mwdblib-4.5.0.dist-info/LICENSE
+-rw-r--r--  2.0 unx      674 b- defN 23-Jul-27 15:14 mwdblib-4.5.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-27 15:14 mwdblib-4.5.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       49 b- defN 23-Jul-27 15:14 mwdblib-4.5.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        8 b- defN 23-Jul-27 15:14 mwdblib-4.5.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3450 b- defN 23-Jul-27 15:14 mwdblib-4.5.0.dist-info/RECORD
+44 files, 146670 bytes uncompressed, 38864 bytes compressed:  73.5%
```

## zipnote {}

```diff
@@ -108,26 +108,26 @@
 
 Filename: mwdblib/cli/formatters/short.py
 Comment: 
 
 Filename: mwdblib/cli/formatters/tabular.py
 Comment: 
 
-Filename: mwdblib-4.4.0.dist-info/LICENSE
+Filename: mwdblib-4.5.0.dist-info/LICENSE
 Comment: 
 
-Filename: mwdblib-4.4.0.dist-info/METADATA
+Filename: mwdblib-4.5.0.dist-info/METADATA
 Comment: 
 
-Filename: mwdblib-4.4.0.dist-info/WHEEL
+Filename: mwdblib-4.5.0.dist-info/WHEEL
 Comment: 
 
-Filename: mwdblib-4.4.0.dist-info/entry_points.txt
+Filename: mwdblib-4.5.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: mwdblib-4.4.0.dist-info/top_level.txt
+Filename: mwdblib-4.5.0.dist-info/top_level.txt
 Comment: 
 
-Filename: mwdblib-4.4.0.dist-info/RECORD
+Filename: mwdblib-4.5.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mwdblib/__version__.py

```diff
@@ -1 +1 @@
-__version__ = "4.4.0"
+__version__ = "4.5.0"
```

## mwdblib/blob.py

```diff
@@ -91,7 +91,13 @@
     def last_seen(self) -> "datetime.datetime":
         """
         :return: datetime object when blob was last seen in MWDB
         """
         if "last_seen" not in self.data:
             self._load()
         return datetime.datetime.fromisoformat(self.data["last_seen"])
+
+    def __repr__(self) -> str:
+        return (
+            f"MWDBBlob(id={repr(self.id)}, name={repr(self.blob_name)}, "
+            f"type={repr(self.blob_type)})"
+        )
```

## mwdblib/comment.py

```diff
@@ -48,7 +48,10 @@
         return cast(str, self.data["comment"])
 
     def delete(self) -> None:
         """
         Deletes this comment
         """
         self.api.delete("object/{}/comment/{}".format(self.parent.id, self.id))
+
+    def __repr__(self) -> str:
+        return f"MWDBComment(id={repr(self.id)}, author={repr(self.author)})"
```

## mwdblib/config.py

```diff
@@ -71,7 +71,13 @@
     def cfg(self) -> Dict[str, Any]:
         """
         Raw dict object with configuration
 
         .. seealso:: :py:attr:`config_dict`
         """
         return self.config
+
+    def __repr__(self) -> str:
+        return (
+            f"MWDBConfig(id={repr(self.id)}, family={repr(self.family)}, "
+            f"type={repr(self.type)})"
+        )
```

## mwdblib/core.py

```diff
@@ -32,14 +32,16 @@
     """
     Main object used for communication with MWDB REST API
 
     :param api_url: MWDB API URL (that ends with '/api/').
     :param api_key: MWDB API key
     :param username: MWDB account username
     :param password: MWDB account password
+    :param autologin: Login automatically using credentials stored in configuration
+        or provided in arguments (default: True)
     :param verify_ssl: Verify SSL certificate correctness (default: True)
     :param obey_ratelimiter: If ``False``, HTTP 429 errors will cause an exception
         like all other error codes.
         If ``True``, library will transparently handle them by sleeping
         for a specified duration. Default is ``True``.
     :param retry_on_downtime: If ``True``, requests will be automatically retried
         after ``downtime_timeout`` seconds on HTTP 502/504 and ConnectionError.
@@ -74,14 +76,17 @@
        If you don't want to automatically fetch them from configuration,
        pass `config_path=None` to the constructor
 
     .. versionadded:: 4.0.0
        Added ``use_keyring``, ``emit_warnings`` and ``config_path`` options.
        ``username`` and ``password`` can be passed directly to the constructor.
 
+    .. versionadded:: 4.4.0
+       Added ``autologin`` option.
+
     Usage example:
 
     .. code-block:: python
 
        from mwdblib import MWDB
 
        mwdb = MWDB()
@@ -146,37 +151,42 @@
     def logout(self) -> None:
         """
         Performs session logout and removes previously set API key.
         """
         self.api.logout()
 
     def _recent(
-        self, object_type: Type[MWDBObjectVar], query: Optional[str] = None
+        self,
+        object_type: Type[MWDBObjectVar],
+        query: Optional[str] = None,
+        chunk_size: Optional[int] = None,
     ) -> Iterator[MWDBObjectVar]:
         """
         Generic implementation of recent_* methods
         """
         try:
             last_object: Optional[MWDBObject] = None
             while True:
                 params = {"older_than": last_object.id} if last_object else {}
                 if query is not None:
                     params["query"] = query
+                if chunk_size is not None:
+                    params["count"] = str(chunk_size)
                 # 'object', 'file', 'config' or 'blob'?
                 result = self.api.get(object_type.URL_TYPE, params=params)
                 key = object_type.URL_TYPE + "s"
                 if key not in result or len(result[key]) == 0:
                     return
                 for obj in result[key]:
                     last_object = object_type.create(self.api, obj)
                     yield cast(MWDBObjectVar, last_object)
         except ObjectNotFoundError:
             return
 
-    def recent_objects(self) -> Iterator[MWDBObject]:
+    def recent_objects(self, chunk_size: Optional[int] = None) -> Iterator[MWDBObject]:
         """
         Retrieves recently uploaded objects
         If you already know type of object you are looking for,
         use specialized variants:
 
         - :py:meth:`recent_files`
         - :py:meth:`recent_configs`
@@ -192,45 +202,53 @@
             mwdb = MWDB()
             mwdb.login("admin", "password123")
 
             # recent_files is generator, do not execute list(recent_files)!
             files = islice(mwdb.recent_files(), 25)
             print([(f.name, f.tags) for f in files])
 
+        :param chunk_size: Number of objects returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBObject`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBObject)
+        return self._recent(MWDBObject, chunk_size=chunk_size)
 
-    def recent_files(self) -> Iterator[MWDBFile]:
+    def recent_files(self, chunk_size: Optional[int] = None) -> Iterator[MWDBFile]:
         """
         Retrieves recently uploaded files
 
+        :param chunk_size: Number of files returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBFile`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBFile)
+        return self._recent(MWDBFile, chunk_size=chunk_size)
 
-    def recent_configs(self) -> Iterator[MWDBConfig]:
+    def recent_configs(self, chunk_size: Optional[int] = None) -> Iterator[MWDBConfig]:
         """
         Retrieves recently uploaded configuration objects
 
+        :param chunk_size: Number of configs returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBConfig`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBConfig)
+        return self._recent(MWDBConfig, chunk_size=chunk_size)
 
-    def recent_blobs(self) -> Iterator[MWDBBlob]:
+    def recent_blobs(self, chunk_size: Optional[int] = None) -> Iterator[MWDBBlob]:
         """
         Retrieves recently uploaded blob objects
 
+        :param chunk_size: Number of blobs returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBBlob`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBBlob)
+        return self._recent(MWDBBlob, chunk_size=chunk_size)
 
     def _listen(
         self,
         last_object: Optional[Union[MWDBObjectVar, str]],
         object_type: Type[MWDBObjectVar],
         blocking: bool,
         interval: int,
@@ -570,15 +588,17 @@
             when object is not found
         :type raise_not_found: bool
         :rtype: :class:`MWDBBlob` or None (if raise_not_found=False)
         :raises: requests.exceptions.HTTPError
         """
         return self._query(MWDBBlob, hash, raise_not_found)
 
-    def search(self, query: str) -> Iterator[MWDBObject]:
+    def search(
+        self, query: str, chunk_size: Optional[int] = None
+    ) -> Iterator[MWDBObject]:
         """
         Advanced search for objects using Lucene syntax.
         If you already know type of objects you are looking for,
         use specialized variants:
 
         - :py:meth:`search_files`
         - :py:meth:`search_configs`
@@ -591,51 +611,65 @@
             from mwdblib import MWDB
 
             # Search for samples tagged as evil and with size less than 100kB
             results = mwdb.search_files("tag:evil AND file.size:[0 TO 100000]")
 
         :param query: Search query
         :type query: str
+        :param chunk_size: Number of objects returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBObject`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBObject, query)
+        return self._recent(MWDBObject, query, chunk_size=chunk_size)
 
-    def search_files(self, query: str) -> Iterator[MWDBFile]:
+    def search_files(
+        self, query: str, chunk_size: Optional[int] = None
+    ) -> Iterator[MWDBFile]:
         """
         Advanced search for files using Lucene syntax.
 
         :param query: Search query
         :type query: str
+        :param chunk_size: Number of files returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBFile`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBFile, query)
+        return self._recent(MWDBFile, query, chunk_size=chunk_size)
 
-    def search_configs(self, query: str) -> Iterator[MWDBConfig]:
+    def search_configs(
+        self, query: str, chunk_size: Optional[int] = None
+    ) -> Iterator[MWDBConfig]:
         """
         Advanced search for configuration objects using Lucene syntax.
 
         :param query: Search query
         :type query: str
+        :param chunk_size: Number of configs returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBConfig`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBConfig, query)
+        return self._recent(MWDBConfig, query, chunk_size=chunk_size)
 
-    def search_blobs(self, query: str) -> Iterator[MWDBBlob]:
+    def search_blobs(
+        self, query: str, chunk_size: Optional[int] = None
+    ) -> Iterator[MWDBBlob]:
         """
         Advanced search for blob objects using Lucene syntax.
 
         :param query: Search query
         :type query: str
+        :param chunk_size: Number of blobs returned per API request
+        :type chunk_size: int
         :rtype: Iterator[:class:`MWDBBlob`]
         :raises: requests.exceptions.HTTPError
         """
-        return self._recent(MWDBBlob, query)
+        return self._recent(MWDBBlob, query, chunk_size=chunk_size)
 
     def _count(
         self, object_type: Type[MWDBObjectVar], query: Optional[str] = None
     ) -> int:
         """
         Generic implementation for count_* methods
         """
@@ -1015,7 +1049,13 @@
                 share_with=share_with,
                 private=private,
                 public=public,
             )
         )
         result = self.api.post("blob", json=params)
         return MWDBBlob(self.api, result)
+
+    def __repr__(self) -> str:
+        return (
+            f"MWDB(api_url={repr(self.api.options.api_url)}, "
+            f"username={repr(self.api.logged_user)})"
+        )
```

## mwdblib/file.py

```diff
@@ -151,7 +151,10 @@
 
     @download.fallback("2.0.0")
     def download_legacy(self) -> bytes:
         token = self.api.post("request/sample/{id}".format(**self.data))["url"].split(
             "/"
         )[-1]
         return cast(bytes, self.api.get("download/{}".format(token), raw=True))
+
+    def __repr__(self) -> str:
+        return f"MWDBFile(sha256={repr(self.id)}, name={repr(self.file_name)})"
```

## mwdblib/karton.py

```diff
@@ -24,7 +24,10 @@
     @property
     def arguments(self) -> Dict[str, Any]:
         return cast(Dict[str, Any], self.data["arguments"])
 
     @property
     def processing_in(self) -> Dict[str, Any]:
         return cast(Dict[str, Any], self.data["processing_in"])
+
+    def __repr__(self) -> str:
+        return f"MWDBKartonAnalysis(id={repr(self.id)})"
```

## mwdblib/api/api.py

```diff
@@ -73,33 +73,47 @@
 
         mwdb = MWDB()
         ...
         # Deletes object with given sha256
         mwdb.api.delete(f'object/{sha256}')
     """
 
-    def __init__(self, _auth_token: Optional[str] = None, **api_options: Any) -> None:
+    def __init__(
+        self,
+        _auth_token: Optional[str] = None,
+        autologin: bool = True,
+        **api_options: Any,
+    ) -> None:
         self.options: APIClientOptions = APIClientOptions(**api_options)
         self.auth_token: Optional[JWTAuthToken] = None
+
+        # These state variables will be filled after
+        # successful authentication
+        self.username: Optional[str] = None
+        self.password: Optional[str] = None
+        self.api_key: Optional[str] = None
+
         self._server_metadata: Optional[dict] = None
 
         self.session: requests.Session = requests.Session()
 
         from ..__version__ import __version__
 
         self.session.headers[
             "User-Agent"
         ] = f'mwdblib/{__version__} {str(self.session.headers["User-Agent"])}'
 
         if _auth_token:
             self.set_auth_token(_auth_token)
-        if self.options.api_key:
-            self.set_api_key(self.options.api_key)
-        elif self.options.username and self.options.password:
-            self.login(self.options.username, self.options.password)
+
+        if autologin:
+            if self.options.api_key:
+                self.set_api_key(self.options.api_key)
+            elif self.options.username and self.options.password:
+                self.login(self.options.username, self.options.password)
 
     @property
     def server_metadata(self) -> dict:
         """
         Information about MWDB Core server from ``/api/server`` endpoint.
         """
         if self._server_metadata is None:
@@ -146,33 +160,33 @@
         :param username: Account username
         :param password: Account password
         """
         token = self.post(
             "auth/login", json={"login": username, "password": password}, noauth=True
         )["token"]
         self.set_auth_token(token)
-        # Store credentials in API options
-        self.options.username = username
-        self.options.password = password
+        # Store credentials in API state
+        self.username = username
+        self.password = password
 
     def set_api_key(self, api_key: str) -> None:
         """
         Sets API key to be used for authorization
 
         .. note:
             It's not recommended to use this method directly.
             Pass ``api_key`` argument to ``MWDB`` constructor.
 
         :param api_key: API key to set
         """
         self.set_auth_token(api_key)
-        # Store credentials in API options
-        self.options.api_key = api_key
+        # Store credentials in API state
+        self.api_key = api_key
         if self.auth_token is not None:
-            self.options.username = self.auth_token.username
+            self.username = self.auth_token.username
 
     def logout(self) -> None:
         """
         Removes authorization token from APIClient instance
         """
         self.auth_token = None
         self.session.headers.pop("Authorization")
@@ -249,18 +263,18 @@
                         "Probably APIClient.api_url points to the MWDB web app "
                         "instead of MWDB REST API."
                     )
             except NotAuthenticatedError:
                 # Forget current auth_key
                 self.logout()
                 # If no password set: re-raise
-                if self.options.password is None:
+                if self.username is None or self.password is None:
                     raise
                 # Try to log in
-                self.login(self.options.username, self.options.password)
+                self.login(self.username, self.password)
                 # Retry failed request...
             except LimitExceededError as e:
                 if not self.options.obey_ratelimiter:
                     raise
                 # Assume that http_error is not Optional for LimitExceededError
                 http_error: HTTPError = cast(HTTPError, e.http_error)
                 if "Retry-After" not in http_error.response.headers:
```

## mwdblib/api/options.py

```diff
@@ -154,22 +154,22 @@
             )
             # If api_key not set: try to fetch password
             if self.api_key is None:
                 self.password = keyring.get_password(
                     f"mwdb:{self.api_url}", self.username
                 )
 
-    def clear_stored_credentials(self, config_writeback: bool = True) -> None:
+    def clear_stored_credentials(self, config_writeback: bool = True) -> bool:
         """
         Clears stored credentials in configuration for current user.
 
         Used by ``mwdb logout`` CLI command.
         """
         if not self.username:
-            return
+            return False
         # Remove credentials from keyring
         if self.use_keyring:
             try:
                 keyring.delete_password(f"mwdb-apikey:{self.api_url}", self.username)
             except keyring.errors.PasswordDeleteError:
                 pass
             try:
@@ -184,23 +184,29 @@
             if self.config_parser.has_option(instance_section, "password"):
                 self.config_parser.remove_option(instance_section, "password")
             if self.config_parser.has_option(instance_section, "api_key"):
                 self.config_parser.remove_option(instance_section, "api_key")
             if config_writeback and self.config_path:
                 with self.config_path.open("w") as f:
                     self.config_parser.write(f)
+        return True
 
-    def store_credentials(self) -> None:
+    def store_credentials(
+        self, username: Optional[str], password: Optional[str], api_key: Optional[str]
+    ) -> bool:
         """
         Stores current credentials in configuration for current user.
 
         Used by ``mwdb login`` CLI command.
         """
-        if not self.username or (not self.api_key and not self.password):
-            return
+        if not username or (not api_key and not password):
+            return False
+        self.username = username
+        self.password = password
+        self.api_key = api_key
         # Clear currently stored credentials
         self.clear_stored_credentials(config_writeback=False)
         # Ensure that 'mwdb' section exists in configuration
         if not self.config_parser.has_section("mwdb"):
             self.config_parser.add_section("mwdb")
         # Set api_url information
         self.config_parser.set("mwdb", "api_url", self.api_url)
@@ -211,20 +217,27 @@
         self.config_parser.set(instance_section, "username", self.username)
         # Set credentials
         if self.use_keyring:
             if self.api_key:
                 keyring.set_password(
                     f"mwdb-apikey:{self.api_url}", self.username, self.api_key
                 )
-            else:
+            elif self.password:
                 keyring.set_password(
                     f"mwdb:{self.api_url}", self.username, self.password
                 )
+            else:
+                raise RuntimeError("Implementation error: no api_key nor password")
+            self.config_parser.set(instance_section, "use_keyring", "1")
         else:
             if self.api_key:
                 self.config_parser.set(instance_section, "api_key", self.api_key)
-            else:
+            elif self.password:
                 self.config_parser.set(instance_section, "password", self.password)
+            else:
+                raise RuntimeError("Implementation error: no api_key nor password")
+            self.config_parser.set(instance_section, "use_keyring", "0")
         # Perform configuration writeback
         if self.config_path:
             with self.config_path.open("w") as f:
                 self.config_parser.write(f)
+        return True
```

## mwdblib/cli/login.py

```diff
@@ -7,46 +7,72 @@
 @main.command("login")
 @click.option(
     "--username", "-u", type=str, default=None, help="MWDB user name (default: ask)"
 )
 @click.option(
     "--password", "-p", type=str, default=None, help="MWDB password (default: ask)"
 )
+@click.option(
+    "--use-keyring/--no-keyring",
+    default=None,
+    help="Don't use keyring, store credentials in plaintext",
+)
 @click.option("--via-api-key", "-A", is_flag=True, help="Use API key provided by stdin")
 @click.option(
     "--api-key",
     "-a",
     type=str,
     default=None,
     help="API key token (default: password-based authentication)",
 )
-@pass_mwdb
+@pass_mwdb(autologin=False)
 @click.pass_context
-def login_command(ctx, mwdb, username, password, via_api_key, api_key):
+def login_command(ctx, mwdb, username, password, use_keyring, via_api_key, api_key):
     """Store credentials for MWDB authentication"""
     if via_api_key:
         api_key = click.prompt("Provide your API key token", hide_input=True)
+
     if api_key is None:
         if username is None:
             username = click.prompt("Username")
         if password is None:
             password = click.prompt("Password", hide_input=True)
 
+    if use_keyring is not None:
+        mwdb.api.options.use_keyring = use_keyring
+
     try:
         # Try to use credentials
         if api_key is None:
             mwdb.login(username, password)
         else:
             # Set API key and check if it's correct
             mwdb.api.set_api_key(api_key)
             mwdb.api.get("auth/validate")
     except (InvalidCredentialsError, NotAuthenticatedError) as e:
         click.echo("Error: Login failed - {}".format(str(e)), err=True)
         ctx.abort()
-    mwdb.api.options.store_credentials()
+    mwdb.api.options.store_credentials(username, password, api_key)
+    if not mwdb.api.options.use_keyring:
+        click.echo(
+            f"Warning! Your password is stored in plaintext in "
+            f"{mwdb.api.options.config_path}. Use --use-keyring to store "
+            f"credentials in keyring (if available on your system).",
+            err=True,
+        )
+    click.echo(
+        f"Logged in successfully to {mwdb.api.options.api_url} "
+        f"as {mwdb.api.logged_user}",
+        err=True,
+    )
 
 
 @main.command("logout")
-@pass_mwdb
+@pass_mwdb(autologin=False)
 def logout_command(mwdb):
     """Reset stored credentials"""
-    mwdb.api.options.clear_stored_credentials()
+    if mwdb.api.options.clear_stored_credentials():
+        click.echo(f"Logged out successfully from {mwdb.api.options.api_url}", err=True)
+    else:
+        click.echo(
+            f"Error: user already logged out from {mwdb.api.options.api_url}!", err=True
+        )
```

## mwdblib/cli/main.py

```diff
@@ -4,45 +4,57 @@
 from click.globals import get_current_context
 
 from .. import __version__
 from ..core import MWDB
 from ..exc import MWDBError, NotAuthenticatedError
 
 
-def pass_mwdb(fn):
-    @click.option("--api-url", type=str, default=None, help="URL to MWDB instance API")
-    @click.option(
-        "--config-path", type=str, default=None, help="Alternative configuration path"
-    )
-    @functools.wraps(fn)
-    def wrapper(*args, **kwargs):
-        ctx = get_current_context()
-        mwdb_options = {}
-        api_url = kwargs.pop("api_url")
-        if api_url:
-            mwdb_options["api_url"] = api_url
-        config_path = kwargs.pop("config_path")
-        if config_path:
-            mwdb_options["config_path"] = config_path
-        mwdb = MWDB(**mwdb_options)
-        try:
-            return fn(mwdb=mwdb, *args, **kwargs)
-        except NotAuthenticatedError:
-            click.echo(
-                "Error: Not authenticated. Use `mwdb login` first to set credentials.",
-                err=True,
-            )
-            ctx.abort()
-        except MWDBError as error:
-            click.echo(
-                "{}: {}".format(error.__class__.__name__, error.args[0]), err=True
-            )
-            ctx.abort()
-
-    return wrapper
+def pass_mwdb(*fn, autologin=True):
+    def uses_mwdb(fn):
+        @click.option(
+            "--api-url", type=str, default=None, help="URL to MWDB instance API"
+        )
+        @click.option(
+            "--config-path",
+            type=str,
+            default=None,
+            help="Alternative configuration path",
+        )
+        @functools.wraps(fn)
+        def wrapper(*args, **kwargs):
+            ctx = get_current_context()
+            mwdb_options = {}
+            api_url = kwargs.pop("api_url")
+            if api_url:
+                mwdb_options["api_url"] = api_url
+            config_path = kwargs.pop("config_path")
+            if config_path:
+                mwdb_options["config_path"] = config_path
+            mwdb = MWDB(autologin=autologin, **mwdb_options)
+            try:
+                return fn(mwdb=mwdb, *args, **kwargs)
+            except NotAuthenticatedError:
+                click.echo(
+                    "Error: Not authenticated. Use `mwdb login` first "
+                    "to set credentials.",
+                    err=True,
+                )
+                ctx.abort()
+            except MWDBError as error:
+                click.echo(
+                    "{}: {}".format(error.__class__.__name__, error.args[0]), err=True
+                )
+                ctx.abort()
+
+        return wrapper
+
+    if fn:
+        return uses_mwdb(fn[0])
+    else:
+        return uses_mwdb
 
 
 @click.group()
 def main():
     """MWDB Core API client"""
     pass
```

## Comparing `mwdblib-4.4.0.dist-info/LICENSE` & `mwdblib-4.5.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mwdblib-4.4.0.dist-info/METADATA` & `mwdblib-4.5.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mwdblib
-Version: 4.4.0
+Version: 4.5.0
 Summary: MWDB API bindings for Python
 Home-page: https://github.com/CERT-Polska/mwdblib
 Author: psrok1
 License: UNKNOWN
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: OS Independent
```

## Comparing `mwdblib-4.4.0.dist-info/RECORD` & `mwdblib-4.5.0.dist-info/RECORD`

 * *Files 20% similar despite different names*

```diff
@@ -1,44 +1,44 @@
 mwdblib/__init__.py,sha256=b5bp3dQGl7rxvSvQ8TT4kZSSklvlpgvh8s19kEZLXfM,479
-mwdblib/__version__.py,sha256=ZMEVsrDCFAaWRcxycPFTA5eXcNSdnxmLtUHTvt__4Tg,22
-mwdblib/blob.py,sha256=UlfZI8uUIWzti3pK-SkMz2goKnrUPhKVuXvm3W7TzZU,2375
-mwdblib/comment.py,sha256=Z88B_xTrbwGsWtlmMf_mhE3rv5EIbCACuEKhmv-KAWA,1211
-mwdblib/config.py,sha256=SF4mQUIu_YuedKmIOOOvFOUoaiyguF8K3EGo8u4t8rk,1953
-mwdblib/core.py,sha256=MP5K2OFaL0dtiMMa038RJcgpY9HyTa2yEaLf2YJi-dQ,37766
+mwdblib/__version__.py,sha256=kasr7b-vOsk9-oG-TlLAfGiJiloadombYp2VxAPe1ck,22
+mwdblib/blob.py,sha256=KD1GsUk_Pok88Vv6wqPCIOd27KcfSqpqmzp-8QRkzwY,2552
+mwdblib/comment.py,sha256=FSDZWswCSGPk2325lRdEN7T96nll4FXZvxkAWp9Zhgw,1321
+mwdblib/config.py,sha256=h5emjFux1QPMk7QnFqK_dvBuLWJnn4jmgjgXKUp5sYE,2126
+mwdblib/core.py,sha256=2vwckmEmiId1D8VmW52NWmoiXEoATxddpdCbB1bPz0g,39599
 mwdblib/exc.py,sha256=-PZtNilZZkheGcQOHJdeE41SL6zIpifqFXjNU6dIVgM,6538
-mwdblib/file.py,sha256=6E-8hoNmojAONk-2uvmFLQX-4-TtUtkvsHi6wsgLyc8,4118
-mwdblib/karton.py,sha256=fiMqSWivvOcX0AjVujsB0vYVJvrevo_KDOj8IOoPAPY,784
+mwdblib/file.py,sha256=g1KhrpNOYJDxIr0mm5JBjvAT_RiFTXFU3WaWvJYvwfc,4230
+mwdblib/karton.py,sha256=VKUWppe5JZSbnyLEP9-L5Nlzx8YvrZQLhHsib-7bXBs,873
 mwdblib/object.py,sha256=EfVkJVMNd2thDi8i7NubKiLrl6LjbM8hg0KAENWUL6Q,14953
 mwdblib/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 mwdblib/share.py,sha256=vZWdoDvpdB9_i1uwEH1ym1bE8MEc_I0LAmo999oL9Ig,2620
 mwdblib/util.py,sha256=uDQUFnuTY44cC4lzy_u7nGMiJpklNPw4qmR_jOQl2eU,1715
 mwdblib/api/__init__.py,sha256=ERXb3CuQhxGXU38z2WCMuqIZ1qAWZ0Gt2J_aJ9bpfsA,110
-mwdblib/api/api.py,sha256=CsrdcxnFixfGg-DnC_OPm86P7ELUFYjl8lL-9SBHTl0,14885
-mwdblib/api/options.py,sha256=pbPeGulx3qYsKmsB_jp8y6-GEhhPtSDuQq9KqpQ5UQk,9237
+mwdblib/api/api.py,sha256=KJfAEwifQx8aKGb0vkpmf57FQhWdVFjV5IGXqs9ABzA,15174
+mwdblib/api/options.py,sha256=7XXgcW6OuvZfcVH7c6m_xkIzVRAm9HmLkqEgwOcz_ys,9837
 mwdblib/cli/__init__.py,sha256=LktVa8Ajyr9sy0ooT_GgH3KwSt7UYeORVRcr4Tm_WpA,1289
 mwdblib/cli/attribute.py,sha256=bO_WQfA_X8ezb_Q1O_L6-M8-Cum7g8qAm861km7sd1U,512
 mwdblib/cli/comment.py,sha256=2joawM80kyLTuQmJSmdn6QNikFpUuX8-kLQhcEbkTnw,496
 mwdblib/cli/fetch.py,sha256=WSKhRVplV1C0NVdWe7pYXAeX3SQuYQhG96fH7zdUkT0,1355
 mwdblib/cli/get.py,sha256=mwbWm-q39FJ5tgdu3g-jatfFX3OyyR_4FYrhSpDbYAo,3018
 mwdblib/cli/link.py,sha256=2zpWW7--2bwOpFK_GLn2mWu8dp3Lkds4wCUMWovG6Wo,584
 mwdblib/cli/list.py,sha256=3r7jfTswasqaNoMbtcAaCqfY-yhm0nqGx0uj1HhmbE0,1510
-mwdblib/cli/login.py,sha256=9-oqnZ8ECgCBWs2ecJlW0hEvch9YivTPNheR9hvpMJg,1630
-mwdblib/cli/main.py,sha256=INq7LG-KDTF7vvfwL1vqjC-GrEx7Rhk4asR1I0TGSPU,1612
+mwdblib/cli/login.py,sha256=utnCGPavn1IyDwXhtL5YtwMBsNgQfPs_oBWhOBSzA80,2588
+mwdblib/cli/main.py,sha256=_iAoRc0SmxgLIPjrjGBzOLfER-G9NvuExnlZ5szvqIg,1950
 mwdblib/cli/metakey.py,sha256=AJWm_rGqLG99BbfquVMJlTLvu3valzEsaMia3Qlcsaw,502
 mwdblib/cli/search.py,sha256=xATZ88ZRX0m2yUXvX3T5cV5qZX509is2FLPU7FgesR4,1664
 mwdblib/cli/share.py,sha256=9Yz_SvoN2dhmWdlQr57BNKkigXYwtzrc_DH5AVZgIR8,504
 mwdblib/cli/tag.py,sha256=9FZHMcbR2iKHQFoNMyQlJnH5IERppY8IZcJy9veeZVM,1003
 mwdblib/cli/types.py,sha256=Cg-FIoHNphIAg-J1YC23lhuYzPbN2g_qJ7mQULlwKWA,960
 mwdblib/cli/upload.py,sha256=1OhQvDBlVg4vjoAIi8pkBZMFtxIbVb2XM4W9T5mVlig,3696
 mwdblib/cli/formatters/__init__.py,sha256=NOlpA5lT08z2h_5YS-Lexn2r_Nrb0ASYPWP54_hgx8Q,103
 mwdblib/cli/formatters/abstract.py,sha256=uv2MTTtNuRk7dwwlx3lAtuHhPCKpMtUiH9fyWewuGVQ,2156
 mwdblib/cli/formatters/attribute.py,sha256=hD_T3QGGBO-5ltBAulfm-kgL57XO-quS9T_7V1uDWx4,2756
 mwdblib/cli/formatters/formatters.py,sha256=-01vlN_5eU8ont7I9suNr9HI77b_fOhx7i63RaKimjU,1417
 mwdblib/cli/formatters/json.py,sha256=5laVRu3TTvUw5ebG_4iBs1UO2JIdBkhaul0BqVnx4DQ,855
 mwdblib/cli/formatters/short.py,sha256=jeTGhFRi9xYN5CrDDV6lD0xIyfD0D9CiTwJ0a5Dd3rQ,1226
 mwdblib/cli/formatters/tabular.py,sha256=6ZSgSiYGMMbZav8Kfgh2g6fxWUjjn4BwtisSwqaUKXo,9036
-mwdblib-4.4.0.dist-info/LICENSE,sha256=73GHmNYSj2OKTdz2q9lgGBg4PVruH8VnykZgus_XQBw,1068
-mwdblib-4.4.0.dist-info/METADATA,sha256=g5B9wc0IUS-fM_2Wqbd8STye7_5QNxTMdbdpnVcCqsI,674
-mwdblib-4.4.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-mwdblib-4.4.0.dist-info/entry_points.txt,sha256=3Rk6COUM5Y0-mGwOz22BcVdQM-5pc594bDhabGAXpiU,49
-mwdblib-4.4.0.dist-info/top_level.txt,sha256=QdrS7yvwzagjS-tH0TK_5AeFUhNePTJo540r_vlrc3k,8
-mwdblib-4.4.0.dist-info/RECORD,,
+mwdblib-4.5.0.dist-info/LICENSE,sha256=73GHmNYSj2OKTdz2q9lgGBg4PVruH8VnykZgus_XQBw,1068
+mwdblib-4.5.0.dist-info/METADATA,sha256=WabqY_dKrY3qXaQXK9sY2LQnpsY_NNr-6A5RQWajxlQ,674
+mwdblib-4.5.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+mwdblib-4.5.0.dist-info/entry_points.txt,sha256=3Rk6COUM5Y0-mGwOz22BcVdQM-5pc594bDhabGAXpiU,49
+mwdblib-4.5.0.dist-info/top_level.txt,sha256=QdrS7yvwzagjS-tH0TK_5AeFUhNePTJo540r_vlrc3k,8
+mwdblib-4.5.0.dist-info/RECORD,,
```

